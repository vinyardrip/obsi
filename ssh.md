
Отличная задача! Настроить SSH в локальной сети на Arch-based дистрибутивах — это фундаментальный навык. Процесс абсолютно идентичен для EndeavourOS и чистого Arch Linux.

Давайте разделим процесс на два этапа:

1. **Настройка "Сервера"** — машины, **КУДА** вы хотите подключиться.
    
2. **Подключение с "Клиента"** — машины, **ОТКУДА** вы хотите подключиться.
    

Допустим, вы хотите подключиться с вашего EndeavourOS на ваш Arch Linux.

- **Машина А (Клиент):** EndeavourOS
    
- **Машина Б (Сервер):** Arch Linux
    

---

### Этап 1: Настройка Машины Б (Arch Linux, Сервер)

На этой машине нам нужно установить SSH-сервер, запустить его и убедиться, что брандмауэр не блокирует подключение.

#### Шаг 1.1: Установка SSH-сервера

Пакет openssh содержит и клиент, и сервер. Скорее всего, он у вас уже есть, но на всякий случай выполним команду для установки/обновления:

Generated bash

```
sudo pacman -Syu openssh
```


#### Шаг 1.2: Запуск и включение службы SSH

Нам нужно запустить службу sshd (SSH Daemon) и включить ее автозапуск при загрузке системы.

Generated bash

```
# Запускаем службу прямо сейчас
sudo systemctl start sshd

# Включаем ее для автоматического запуска при каждой загрузке
sudo systemctl enable sshd
```


Вы можете проверить статус службы, чтобы убедиться, что все в порядке:

Generated bash

````
sudo systemctl status sshd
```Вы должны увидеть зеленую надпись `active (running)`.

#### Шаг 1.3: Настройка брандмауэра (Очень важно!)

Это самый частый источник проблем. Если у вас включен брандмауэр (например, `ufw`), он будет блокировать входящие SSH-подключения по умолчанию.

**Если вы используете `ufw` (распространенный выбор):**

```bash
# Разрешаем входящие подключения по SSH (использует стандартный порт 22)
sudo ufw allow ssh

# Или можно указать порт напрямую
# sudo ufw allow 22

# Перезагружаем ufw, чтобы применить правила
sudo ufw reload

# Проверяем статус
sudo ufw status
````


Вы должны увидеть в списке 22/tcp ALLOW или ssh ALLOW.

**Если у вас другой брандмауэр**, вам нужно будет найти инструкцию для него (например, для firewalld команда будет sudo firewall-cmd --add-service=ssh --permanent).

#### Шаг 1.4: Узнаем IP-адрес и имя пользователя

Теперь нам нужны две вещи с этой машины, чтобы подключиться к ней:

1. **Локальный IP-адрес.**
    
2. **Имя пользователя.**
    

Выполните команду ip a или ip address:```bash  
ip a

Generated code

````
Ищите свой сетевой интерфейс (часто `enpXsY` для проводного или `wlanX` для Wi-Fi). Вам нужна строка, начинающаяся с `inet`, например:
`inet 192.168.1.105/24 ...`
В данном случае ваш IP-адрес — **`192.168.1.105`**.

Чтобы узнать ваше текущее имя пользователя, выполните:
```bash
whoami
```Допустим, команда вывела `archuser`.

**Итак, с Машины Б мы получили:**
*   IP-адрес: `192.168.1.105`
*   Имя пользователя: `archuser`

Машина Б готова к приему подключений.

---

### Этап 2: Подключение с Машины А (EndeavourOS, Клиент)

Здесь все намного проще. Нам нужен только SSH-клиент (он уже установлен вместе с `openssh`) и данные, которые мы получили на предыдущем этапе.

#### Шаг 2.1: Команда для подключения

Откройте терминал на Машине А и используйте следующую команду, подставив ваши данные:
`ssh <имя_пользователя>@<ip_адрес>`

В нашем примере это будет:
```bash
ssh archuser@192.168.1.105
````


#### Шаг 2.2: Первое подключение

При самом первом подключении вы увидите сообщение о "подлинности хоста" (host authenticity). Это нормально и является частью механизма безопасности SSH.The authenticity of host '192.168.1.105 (192.168.1.105)' can't be established. ED25519 key fingerprint is SHA256:xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx. Are you sure you want to continue connecting (yes/no/[fingerprint])?  
Смело пишите yes и нажимайте Enter. SSH запомнит "отпечаток" этого сервера, и в следующий раз спрашивать не будет.

#### Шаг 2.3: Ввод пароля

Далее вас попросят ввести пароль:  
archuser@192.168.1.105's password:

**Важно:** Вводите пароль от пользователя archuser на **Машине Б (сервере)**. При вводе вы не будете видеть ни символов, ни звездочек. Просто вводите пароль и нажимайте Enter.

Если все правильно, вы увидите приглашение командной строки вашей машины с Arch Linux! Поздравляю, вы подключились.

---

### Устранение проблем

- **Connection timed out (Тайм-аут соединения):** Скорее всего, брандмауэр на Машине Б блокирует порт 22. Проверьте правила ufw.
    
- **Connection refused (В соединении отказано):** Служба sshd на Машине Б не запущена. Проверьте sudo systemctl status sshd.
    
- **Permission denied (publickey,password):** Неверный пароль или имя пользователя. Проверьте еще раз.
    

### Следующий шаг (Pro Tip): Вход по SSH-ключам

Постоянно вводить пароль неудобно. Настройте вход по ключам — это и безопаснее, и быстрее.

1. **На Машине А (клиенте):** Если у вас еще нет ключа, сгенерируйте его: ssh-keygen.
    
2. **На Машине А (клиенте):** Скопируйте ваш публичный ключ на Машину Б с помощью одной простой команды:
    
    Generated bash
    
    ```
    ssh-copy-id archuser@192.168.1.105
    ```
    
    
    Вас попросят ввести пароль в последний раз. После этого при всех последующих подключениях пароль спрашивать не будут.

!!!!!!! UFW  **Примеры того, что может "отпилиться":** 

- **Файловые шары:** Если вы используете Samba (для доступа с Windows/macOS) или NFS для обмена файлами, к ним пропадет доступ.
    
- **Медиа-серверы:** Plex, Jellyfin, Emby станут недоступны с других устройств.
    
- **Игровые серверы:** Если вы хостите игровой сервер (например, для Minecraft, Valheim и т.д.), никто не сможет к нему подключиться.
    
- **Веб-серверы:** Если вы для разработки держите локальный веб-сервер (Apache, Nginx), он перестанет открываться с других машин.
    
- **Любые другие приложения**, которые работают по сетевому принципу "сервер-клиент", где ваш Arch выступает сервером.