
# Распределение ресурсов KVM для ВМ на Dell Inspiron 7720

**Теги:** #virtualization #kvm #resourcemanagement #nixos #windows11 #hyprland

Эта заметка описывает оптимальное распределение ресурсов (ЦП и ОЗУ) для виртуальных машин NixOS и Windows 11, запущенных на ноутбуке Dell Inspiron 7720 с Arch Linux в качестве хоста.

> [!NOTE] Главный принцип
> Ключ к успеху — баланс. Нужно выделить достаточно ресурсов для комфортной работы гостевой ОС, но **никогда не в ущерб хост-системе**. Хосту всегда нужны ресурсы для управления виртуализацией и рендеринга графики (особенно с VirtIO 3D).

---

### Характеристики хост-системы (Arch Linux)

*   **Процессор:** Intel Core i7-3610QM (`4 ядра / 8 потоков`)
*   **ОЗУ:** 16 ГБ

---

### VM 1: NixOS + Hyprland (Рабочая/Тестовая среда)

**Цель:** Плавная работа графического интерфейса, быстрая компиляция пакетов Nix. Эта ВМ более требовательна к ресурсам.

#### Распределение ресурсов для NixOS

*   #### **Процессор (CPU): 4 потока (50%)**
    *   **Почему:** Это "золотая середина". Выделение половины доступных потоков обеспечивает отличную отзывчивость внутри ВМ и позволяет ускорить сборку пакетов. При этом у хост-системы Arch Linux остается 4 потока для собственных нужд, включая обработку 3D-команд от гостевой ОС.
    *   **Минимум:** `2 потока (25%)` - для базовых задач и настройки конфигов.
    *   **Максимум:** `6 потоков (75%)` - не рекомендуется, может вызвать "заикания" (stuttering) на хосте.

*   #### **Оперативная память (RAM): 6 ГБ (37.5%)**
    *   **Почему:** Hyprland и современные приложения потребляют память. 4 ГБ — это хороший старт, но 6 ГБ создадут комфортный запас для компиляции в `nix-shell` или запуска нескольких приложений одновременно, не заставляя систему использовать swap.
    *   **Стартовая точка:** `4 ГБ (25%)`.
    *   **Для интенсивной работы:** `8 ГБ (50%)`.

> [!TIP] Итог для NixOS + Hyprland
> **Рекомендованная конфигурация: 4 vCPU / 6144 МБ RAM.**

---

### VM 2: Windows 11 (Утилитарная среда)

**Цель:** Стабильная работа для конкретных задач, таких как использование электронной подписи или запуск специфичного Windows-софта. Требования к производительности ниже.

#### Распределение ресурсов для Windows 11

*   #### **Процессор (CPU): 2 потока (25%)**
    *   **Почему:** Windows 11 требует минимум 2 ядра. Выделение 2 потоков соответствует этому требованию и является достаточным для легких задач. Система может быть не очень быстрой, но будет стабильной. Для повышения отзывчивости можно увеличить до 4 потоков.
    *   **Комфортный вариант:** `4 потока (50%)`.
    *   **Минимальные требования:** `2 потока (25%)`.

*   #### **Оперативная память (RAM): 4 ГБ (25%)**
    *   **Почему:** Это официальный минимум от Microsoft. Для запуска одного-двух приложений (например, крипто-клиента) этого объема вполне достаточно.
    *   **Если планируется браузер:** `6-8 ГБ (37.5% - 50%)`.

> [!TIP] Итог для Windows 11
> **Рекомендованная конфигурация: 2 vCPU / 4096 МБ RAM.**
> (Для большей плавности — 4 vCPU).

---

> [!WARNING] Одновременный запуск двух ВМ
> Если вы планируете запускать обе виртуальные машины одновременно, их суммарные ресурсы не должны истощать хост. В этом случае рекомендуется снизить выделяемые ресурсы.
> *   **Пример безопасного разделения:**
>     *   **NixOS:** 2 vCPU / 4 ГБ RAM
>     *   **Windows:** 2 vCPU / 4 ГБ RAM
>     *   **Итого для ВМ:** 4 из 8 потоков и 8 из 16 ГБ ОЗУ.